# 自动登录功能说明

## 功能概述

自动登录功能允许用户在登录时选择保存登录信息，下次应用启动或登录过期时自动使用保存的登录方式进行登录，提升用户体验。

## 功能特性

### 1. 自动登录选项
- 在登录页面提供"自动登录"复选框
- 默认选中状态
- 用户可手动取消选择

### 2. 支持的登录方式
- **密码登录**: 保存手机号和密码，支持自动登录
- **验证码登录**: 保存手机号，但不支持自动登录（需要重新获取验证码）
- **微信登录**: 保存登录方式，支持自动登录

### 3. 数据存储
- 登录信息保存到本地存储
- 设置7天过期时间
- 使用加密存储保护用户隐私

### 4. 自动登录触发场景
- 应用启动时检查并执行
- Token过期时自动尝试登录
- 网络请求返回401状态码时自动尝试登录

## 使用方法

### 用户操作
1. 在登录页面勾选"自动登录"选项
2. 完成登录后，登录信息自动保存
3. 下次启动应用或登录过期时，系统自动登录

### 开发者配置
1. 自动登录功能已集成到用户状态管理中
2. 无需额外配置，开箱即用
3. 支持自定义过期时间和存储策略

## 技术实现

### 核心组件
- `src/stores/user.ts`: 用户状态管理，包含自动登录相关方法
- `src/pages/auth/login.vue`: 登录页面，包含自动登录选项
- `src/utils/request.ts`: 网络请求拦截，处理401状态码
- `src/App.vue`: 应用启动时的自动登录检查

### 关键方法
```typescript
// 保存自动登录信息
saveAutoLoginInfo(info: {
  type: 'password' | 'code' | 'wechat'
  phone: string
  password?: string
})

// 获取自动登录信息
getAutoLoginInfo()

// 执行自动登录
executeAutoLogin()

// 清除自动登录信息
clearAutoLoginInfo()

// 验证token有效性
validateToken()
```

### 数据存储结构
```typescript
interface AutoLoginInfo {
  type: 'password' | 'code' | 'wechat'  // 登录方式
  phone: string                          // 手机号
  password?: string                      // 密码（仅密码登录时）
}
```

## 安全考虑

### 数据保护
- 登录信息存储在本地，不上传到服务器
- 设置合理的过期时间（7天）
- 登录失败时自动清除保存的信息

### 隐私保护
- 用户可随时取消自动登录选项
- 退出登录时自动清除所有保存的信息
- 支持手动清除自动登录信息

## 注意事项

### 限制说明
1. 验证码登录不支持自动登录（需要重新获取验证码）
2. 微信登录的自动登录需要重新获取授权
3. 密码登录的自动登录需要确保密码正确

### 兼容性
- 支持所有uni-app平台
- 兼容微信小程序环境
- 支持H5和App环境

## 故障排除

### 常见问题
1. **自动登录失败**: 检查网络连接和登录信息是否正确
2. **信息不保存**: 确认是否勾选了自动登录选项
3. **过期不生效**: 检查本地存储是否正常工作

### 调试方法
- 查看控制台日志输出
- 检查本地存储中的自动登录信息
- 验证token的有效性

## 更新日志

### v1.0.0 (2024-01-01)
- 初始版本发布
- 支持密码登录和微信登录的自动登录
- 集成到现有的用户状态管理系统
- 添加完整的错误处理和日志记录
